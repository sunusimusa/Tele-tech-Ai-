<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Tele Tech AI (Text)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="font-family:Arial; background:#f4f6f9;">

<div style="
  max-width:600px;
  margin:40px auto;
  padding:20px;
  background:#fff;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,.1);
">

<h2 style="text-align:center;">Tele Tech AI (Text)</h2>

<!-- CHAT AREA -->
<div id="chat" style="
  height:300px;
  overflow-y:auto;
  border:1px solid #ddd;
  padding:10px;
  margin-bottom:10px;
">
</div>

<!-- INPUT -->
<textarea id="msg"
  placeholder="Rubuta sakonka a nan..."
  style="width:100%;height:70px;"></textarea>

<button onclick="sendMsg()"
  style="margin-top:10px; padding:10px 20px; background:#28a745; color:#fff; border:none; border-radius:6px;">
  Send
</button>

</div>
<script>
function addMessage(sender, text) {
  const chat = document.getElementById("chat");

  const msgDiv = document.createElement("div");
  msgDiv.style.marginBottom = "8px";
  msgDiv.style.padding = "8px";
  msgDiv.style.borderRadius = "6px";
  msgDiv.style.background =
    sender === "You" ? "#d1e7ff" : "#f1f1f1";

  msgDiv.innerHTML = `
    <b>${sender}:</b> ${text}
    <span
      style="float:right;cursor:pointer;color:red;font-weight:bold;"
      onclick="this.parentElement.remove()"
    >‚ùå</span>
  `;

  chat.appendChild(msgDiv);
  chat.scrollTop = chat.scrollHeight;
}

async function sendMsg() {
  const input = document.getElementById("msg");
  const message = input.value.trim();
  if (!message) return;

  // üë§ User message
  addMessage("You", message);
  input.value = "";

  // ü§ñ AI thinking
  const thinkingId = document.createElement("div");
  thinkingId.style.color = "gray";
  thinkingId.innerText = "AI: Thinking...";
  document.getElementById("chat").appendChild(thinkingId);

  try {
    const res = await fetch("/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message })
    });

    const data = await res.json();
    thinkingId.remove();

    addMessage("AI", data.success ? data.reply : "Error");

  } catch (e) {
    thinkingId.remove();
    addMessage("AI", "Server error ‚ùå");
  }
}
</script>
</body>
</html>
