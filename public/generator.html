<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Tele Tech AI (Text)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="font-family:Arial; background:#f4f6f9;">

<div style="
  max-width:600px;
  margin:40px auto;
  padding:20px;
  background:#fff;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,.1);
">

<h2 style="text-align:center;">Tele Tech AI (Text)</h2>

<!-- CHAT AREA -->
<div id="chat" style="
  height:300px;
  overflow-y:auto;
  border:1px solid #ddd;
  padding:10px;
  margin-bottom:10px;
">
</div>

<!-- INPUT -->
<textarea id="msg"
  placeholder="Rubuta sakonka a nan..."
  style="width:100%;height:70px;"></textarea>

<button onclick="sendMsg()"
  style="margin-top:10px; padding:10px 20px; background:#28a745; color:#fff; border:none; border-radius:6px;">
  Send
</button>

</div>

<script>
async function sendMsg() {
  const input = document.getElementById("msg");
  const chat = document.getElementById("chat");
  const message = input.value.trim();

  if (!message) return;

  // USER MESSAGE
  const userDiv = document.createElement("div");
  userDiv.style.marginBottom = "8px";
  userDiv.innerHTML = `
    <b>You:</b> ${message}
    <span onclick="this.parentElement.remove()"
      style="color:red; cursor:pointer; margin-left:8px;">
      üóëÔ∏è
    </span>
  `;
  chat.appendChild(userDiv);

  input.value = "";
  chat.scrollTop = chat.scrollHeight;

  // THINKING
  const aiDiv = document.createElement("div");
  aiDiv.style.marginBottom = "8px";
  aiDiv.style.color = "gray";
  aiDiv.innerHTML = `<b>AI:</b> Thinking...`;
  chat.appendChild(aiDiv);
  chat.scrollTop = chat.scrollHeight;

  try {
    const res = await fetch("/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message })
    });

    const data = await res.json();

    aiDiv.innerHTML = `
      <b>AI:</b> ${data.success ? data.reply : "Error"}
      <span onclick="this.parentElement.remove()"
        style="color:red; cursor:pointer; margin-left:8px;">
        üóëÔ∏è
      </span>
    `;

  } catch (e) {
    aiDiv.innerHTML = `<b>AI:</b> Server error ‚ùå`;
  }

  chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>
