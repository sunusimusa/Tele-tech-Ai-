<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tele Tech AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="font-family:Arial; background:#f4f6f9;">

<div style="
  max-width:600px;
  margin:40px auto;
  padding:20px;
  background:#fff;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,.1);
">

<h2 style="text-align:center;">Tele Tech AI (Text)</h2>

<!-- CHAT HISTORY -->
<div id="chat" style="
  height:300px;
  overflow-y:auto;
  border:1px solid #ddd;
  padding:10px;
  margin-bottom:10px;
  background:#fafafa;
"></div>

<!-- INPUT -->
<textarea id="msg"
  placeholder="Rubuta sakonka a nan..."
  style="width:100%; height:80px; padding:10px;"></textarea>

<button onclick="sendMsg()"
  style="margin-top:10px; padding:10px 20px;">
  Send
</button>

</div>

<script>
async function sendMsg() {
  const input = document.getElementById("msg");
  const chat = document.getElementById("chat");
  const message = input.value.trim();

  if (!message) return;

  // üßç‚Äç‚ôÇÔ∏è Sakon user
  chat.innerHTML += `
    <div style="margin-bottom:8px;">
      <b>You:</b> ${message}
    </div>
  `;

  input.value = "";
  chat.scrollTop = chat.scrollHeight;

  // ü§ñ Thinking...
  const thinkingId = "thinking-" + Date.now();
  chat.innerHTML += `
    <div id="${thinkingId}" style="color:gray;">
      <b>AI:</b> Thinking...
    </div>
  `;
  chat.scrollTop = chat.scrollHeight;

  try {
    const res = await fetch("/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message })
    });

    const data = await res.json();

    document.getElementById(thinkingId).innerHTML = `
      <b>AI:</b> ${data.success ? data.reply : "Error"}
    `;
    chat.scrollTop = chat.scrollHeight;

  } catch (e) {
    document.getElementById(thinkingId).innerHTML =
      "<b>AI:</b> Server error ‚ùå";
  }
}
</script>

</body>
</html>
